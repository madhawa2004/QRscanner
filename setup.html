<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Setup Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="d-flex align-items-center justify-content-center vh-100 bg-dark text-white">

    <div class="text-center">
        <h1>üõ†Ô∏è Admin Fixer</h1>
        <p>‡∂î‡∂∫‡∑è‡∂ú‡∑ö Admin Email ‡∂ë‡∂ö Database ‡∂ë‡∂ö‡∂ß Link ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂¥‡∑Ñ‡∑Ö ‡∂∂‡∂ß‡∑ä‡∂±‡∑ä ‡∂ë‡∂ö ‡∂î‡∂∂‡∂±‡∑ä‡∂±.</p>
        
        <input type="text" id="adminEmail" class="form-control mb-3 text-center" value="admin@scout.com">
        
        <button onclick="fixAdmin()" class="btn btn-success btn-lg">Fix Admin Account</button>
    </div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // üî¥ 2. ‡∂î‡∂∫‡∑è‡∂ú‡∑ö FIREBASE CONFIG ‡∂ë‡∂ö ‡∂∏‡∑ô‡∂≠‡∂±‡∂ß ‡∂Ø‡∑è‡∂±‡∑ä‡∂±
    const firebaseConfig = {
        apiKey: "AIzaSyBsBsKnXv6FgYVk7OLo0XagFSBZgYajuNA",
        authDomain: "qr-system-02---web-based.firebaseapp.com",
        projectId: "qr-system-02---web-based",
        storageBucket: "qr-system-02---web-based.firebasestorage.app",
        messagingSenderId: "742559334366",
        appId: "1:742559334366:web:0c104f39997de0572fe74f"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    window.fixAdmin = async function() {
        const email = document.getElementById('adminEmail').value.trim();
        
        if(!email) return Swal.fire('Error', 'Email ‡∂ë‡∂ö ‡∑Ñ‡∑í‡∑É‡∑ä', 'error');

        try {
            // Database ‡∂ë‡∂ö‡∑ö 'users' ‡∂Ω‡∑í‡∑É‡∑ä‡∂ß‡∑ä ‡∂ë‡∂ö‡∂ß ‡∂∏‡∑ô‡∂∫‡∑è Admin ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è ‡∂Ω‡∑í‡∂∫‡∂±‡∑Ä‡∑è
            await setDoc(doc(db, "users", email), {
                email: email,
                role: "admin", // ‡∂∂‡∂Ω‡∑ô‡∂±‡∑ä Admin ‡∂Ø‡∑ô‡∂±‡∑Ä‡∑è
                createdAt: serverTimestamp()
            });

            Swal.fire({
                icon: 'success',
                title: 'Fixed!',
                text: '‡∂Ø‡∑ê‡∂±‡∑ä index.html ‡∂ë‡∂ö‡∂ß ‡∂ú‡∑í‡∑Ñ‡∑í‡∂±‡∑ä Log ‡∑Ä‡∑ô‡∂±‡∑ä‡∂±.',
            });
        } catch (e) {
            Swal.fire('Error', e.message, 'error');
        }
    }
</script>
</body>
</html>